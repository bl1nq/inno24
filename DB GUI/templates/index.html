<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Arduino Steuerung</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
</head>
<body>
    <h1>Arduino Steuerung</h1>

    <!-- Statusanzeige -->
    <div id="status">
        <span id="system_status">System DISARMED</span>
        <button id="arm_button">Arm</button>
    </div>

    <!-- Datenanzeige -->
    <div id="data_display">
        <h2>Sensordaten</h2>
        <p>Aktuelle Distanz: <span id="distance">0.0</span> mm</p>
        <p>Standardabweichung: <span id="distance_std_dev">0.0</span></p>
        <p>ESC Geschwindigkeit (PWM): <span id="esc_speed_display">0</span> µs</p>
        <p>Stepper Winkel: <span id="stepper_angle_display">0.0</span> Grad</p>
        <p>Stepper Winkelgeschwindigkeit: <span id="stepper_angular_speed">0.0</span> Grad/s</p>
    </div>

    <!-- Einstellungen -->
    <div id="controls">
        <h2>Einstellungen</h2>

        <!-- ESC Geschwindigkeit -->
        <div>
            <label for="esc_speed">ESC Geschwindigkeit (1000 - 2000 µs):</label>
            <input type="number" id="esc_speed" min="1000" max="2000" value="1000">
            <button id="set_esc_speed">Setzen</button>
        </div>

        <!-- Stepper Winkel -->
        <div>
            <label for="stepper_angle">Stepper Winkel (0 - 90 Grad):</label>
            <input type="number" id="stepper_angle" min="0" max="90" value="0">
            <button id="set_stepper_angle">Setzen</button>
        </div>

        <!-- Laser Einstellungen -->
        <div>
            <label for="laser_measurements">Anzahl Laser Messungen:</label>
            <input type="number" id="laser_measurements" min="1" max="100" value="3">
            <button id="set_laser_measurements">Setzen</button>

            <label for="timing_budget">Timing Budget (ms):</label>
            <input type="number" id="timing_budget" min="15" max="500" value="50">
            <button id="set_timing_budget">Setzen</button>
        </div>

        <!-- Stepper Einstellungen -->
        <div>
            <button id="reset_stepper_zero">Reset Stepper Nullpunkt</button>

            <label for="stepper_max_speed">Stepper Max Geschwindigkeit:</label>
            <input type="number" id="stepper_max_speed" min="100" max="5000" value="1000">
            <button id="set_stepper_max_speed">Setzen</button>

            <label for="stepper_accel">Stepper Beschleunigung:</label>
            <input type="number" id="stepper_accel" min="100" max="5000" value="500">
            <button id="set_stepper_accel">Setzen</button>
        </div>
    </div>

    <!-- Prediction -->
    <div id="prediction">
        <h2>Prediction</h2>
        <label for="param_a">Parameter a:</label>
        <input type="number" id="param_a" value="1.0">
        <label for="param_b">Parameter b:</label>
        <input type="number" id="param_b" value="0.0">
        <label for="param_c">Parameter c:</label>
        <input type="number" id="param_c" value="0.0">

        <p>Vorhergesagter Winkel: <span id="predicted_angle">0.0</span> Grad</p>
        <p>Vorhergesagte Geschwindigkeit: <span id="predicted_speed">0.0</span> µs</p>
    </div>

    <!-- Daten absichern -->
    <div id="data_saving">
        <h2>Daten absichern</h2>
        <label for="actual_distance">Gemessene Distanz:</label>
        <input type="number" id="actual_distance" value="0.0">

        <label for="filename">Dateiname:</label>
        <input type="text" id="filename" value="data.csv">

        <button id="save_data">Daten speichern</button>
    </div>

    <!-- Debug Anzeige -->
    <div id="debug">
        <h2>Debug Meldungen</h2>
        <textarea id="debug_messages" rows="10" cols="100" readonly></textarea>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
